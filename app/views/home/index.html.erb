<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-contents">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><span class="glyphicon glyphicon-send"></span> Data Structure Explorer</a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-contents">
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown" data-ng-class="{ active: active_page == 0 }">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-edit"></span> Edit <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li data-ng-repeat="data_structure in data_structures" data-ng-class="{ active: active_page == 0 && active_data_structure == data_structure }"><a href="#" data-ng-click="editDataStructure(data_structure); $event.preventDefault();">{{ data_structure.name || 'Untitled' }}</a></li>
            <li class="divider"></li>
            <li><a href="#" data-ng-click="newDataStructure(); $event.preventDefault();"><span class="glyphicon glyphicon-plus"></span> New data structure</a></li>
          </ul>
        </li>
        <li class="dropdown" data-ng-class="{ active: active_page == 1 }">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-globe"></span> Explore <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li data-ng-repeat="data_structure in data_structures" data-ng-class="{ active: active_page == 1 && active_data_structure == data_structure }"><a href="#" data-ng-click="exploreDataStructure(data_structure); $event.preventDefault();">{{ data_structure.name || 'Untitled' }}</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container-fluid" data-ng-show="active_page == 0">
  <div data-ng-hide="active_data_structure">
    <div class="row">
      <div class="col-sm-12">
        <h2>Data structure editor</h2>
        <hr />
        <a href="#" class="btn btn-primary" data-ng-click="newDataStructure(); stopClick($event);">New data structure</a>
      </div>
    </div>
  </div>
  <div data-ng-show="active_data_structure">
    <div class="row">
      <div class="col-sm-12">
        <h2>Edit: {{ active_data_structure.name || 'Untitled' }}</h2>
        <hr />
      </div>
    </div>
    <div class="row">
      <div class="col-sm-4">
        <div class="panel panel-default">
          <div class="panel-heading">Basic properties</div>
          <div class="panel-body">
            <div class="form-group">
              <label for="ds-name">Name</label>
              <input id="ds-name" type="text" class="form-control" placeholder="e.g., Binary search tree" data-ng-model="active_data_structure.name" />
            </div>

            <div class="form-group">
              <label for="ds-model">Model of computation</label>
              <select id="ds-model" class="form-control" data-ng-model="active_data_structure.model" data-ng-options="model as model.name for model in models">
              </select>
            </div>

            <p class="no-bottom-margin">
              <a href="#" class="btn btn-danger" data-ng-click="deleteDataStructure(active_data_structure); stopClick($event);"><span class="glyphicon glyphicon-trash"></span> Delete data structure</a>
            </p>
          </div>
        </div>

        <div class="panel panel-default" data-ng-show="active_data_structure.model == models[0]">
          <div class="panel-heading">Node fields</div>
          <div class="panel-body">
            <ul data-ng-show="active_data_structure.fields.length > 0">
              <li data-ng-repeat="field in active_data_structure.fields">
                <div class="dropdown">
                  <a data-toggle="dropdown" href="#"><code>{{ field }}</code></a>
                  <ul class="dropdown-menu">
                    <li><a href="#" data-ng-click="moveFieldUp(active_data_structure, field); $event.preventDefault();" data-ng-hide="$first"><i class="fi-arrow-up"></i> Move up</a></li>
                    <li><a href="#" data-ng-click="moveFieldDown(active_data_structure, field); $event.preventDefault();" data-ng-hide="$last"><i class="fi-arrow-down"></i> Move down</a></li>
                    <li><a href="#" data-ng-click="deleteField(active_data_structure, field); $event.preventDefault();"><i class="fi-minus-circle"></i> Delete</a></li>
                  </ul>
                </div>
              </li>
            </ul>
            <form data-ng-submit="addField(active_data_structure); $event.preventDefault();">
              <div class="form-group no-bottom-margin" data-ng-class="{ 'has-error': new_field_error }">
                <div class="input-group">
                  <input type="text" class="form-control" data-ng-model="new_field_name" data-ng-focus="clearAddFieldError()" data-ng-blur="clearAddFieldError()" placeholder="e.g., left_child" />
                  <span class="input-group-btn">
                    <button type="submit" class="btn btn-default" data-ng-blur="clearAddFieldError()"><span class="glyphicon glyphicon-plus"></span> Add field</button>
                  </span>
                </div>
                <p class="no-bottom-margin" data-ng-show="new_field_error">{{ new_field_error }}</p>
              </div>
            </form>
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading">Operations</div>
          <div class="panel-body">
            <ul data-ng-show="active_data_structure.operations.length > 0">
              <li data-ng-repeat="operation in active_data_structure.operations">
                <div class="dropdown">
                  <a data-toggle="dropdown" href="#"><code>{{ operation.name }}(<span data-ng-hide="operation.arguments">&hellip;</span><span data-ng-repeat="arg in operation.arguments"><span ng-hide="$first">, </span>{{ arg }}</span>)</code></a>
                  <ul class="dropdown-menu">
                    <li><a href="#" data-ng-click="moveOperationUp(active_data_structure, operation); $event.preventDefault();" data-ng-hide="$first"><i class="fi-arrow-up"></i> Move up</a></li>
                    <li><a href="#" data-ng-click="moveOperationDown(active_data_structure, operation); $event.preventDefault();" data-ng-hide="$last"><i class="fi-arrow-down"></i> Move down</a></li>
                    <li><a href="#" data-ng-click="deleteOperation(active_data_structure, operation); $event.preventDefault();"><i class="fi-minus-circle"></i> Delete</a></li>
                  </ul>
                </div>
              </li>
            </ul>
            <form data-ng-submit="addOperation(active_data_structure); $event.preventDefault();">
              <div class="form-group no-bottom-margin" data-ng-class="{ 'has-error': new_operation_error }">
                <div class="input-group">
                  <input type="text" class="form-control" data-ng-model="new_operation_name" data-ng-focus="clearAddOperationError()" data-ng-blur="clearAddOperationError()" placeholder="e.g., insert" />
                  <span class="input-group-btn">
                    <button type="submit" class="btn btn-default" data-ng-blur="clearAddOperationError()"><span class="glyphicon glyphicon-plus"></span> Add operation</button>
                  </span>
                </div>
                <p class="no-bottom-margin" data-ng-show="new_operation_error">{{ new_operation_error }}</p>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="col-sm-8">
        <div data-ng-repeat="operation in active_data_structure.operations">
          <div class="form-group">
            <label for="ds-code-{{ operation.name }}"><code>{{ operation.name }}(<span data-ng-hide="operation.arguments">&hellip;</span><span data-ng-repeat="arg in operation.arguments"><span ng-hide="$first">, </span>{{ arg }}</span>)</code></label>
            <textarea id="ds-code-{{ operation.name }}" class="form-control operation-code" data-ng-model="operation.code" placeholder="Define the operation in JavaScript."></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid" data-ng-show="active_page == 1">
  <div data-ng-hide="active_data_structure">
    <div class="row">
      <div class="col-sm-12">
        <h2>Data structure explorer</h2>
        <hr />
        <p>Switch to the <a href="#" data-ng-click="active_page = 0; stopClick($event);">Edit</a> view and define a data structure.</p>
      </div>
    </div>
  </div>
  <div data-ng-show="active_data_structure">
    <div class="row">
      <div class="col-sm-12">
        <h2>Explore: {{ active_data_structure.name || 'Untitled' }}</h2>
        <hr />
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3">
        <div class="panel panel-default">
          <div class="panel-heading">Basic properties</div>
          <div class="panel-body">
            <p class="no-bottom-margin">Model of computation: <em>{{ active_data_structure.model.name }}</em></p>
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading">Operations</div>
          <div class="panel-body">
            <ul class="no-bottom-margin" data-ng-show="active_data_structure.operations.length > 0">
              <li data-ng-repeat="operation in active_data_structure.operations">
                <code>{{ operation.name }}(<span data-ng-repeat="arg in operation.arguments"><span ng-hide="$first">, </span>{{ arg }}</span>)</code>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-sm-6"> 

      </div>
      <div class="col-sm-3"> 
        <div class="panel panel-default">
          <div class="panel-heading">Command history</div>
          <div class="panel-body">
            <ul id="command-history" class="list-unstyled" data-ng-show="command_history.length > 0">
              <li class="command" data-ng-repeat="command in command_history">
                <span data-ng-class="{ 'command-active': $index == command_history_cursor }">{{ command.str }}</span>
                <ul>
                  <li data-ng-repeat="step in command.steps" data-ng-class="{ 'command-step-active': $parent.$index == command_history_cursor && $index == command_history_step_cursor }">{{ step.repr }}</li>
                </ul>
              </li>
            </ul>

            <form data-ng-submit="newCommand(); $event.preventDefault();">
              <div class="form-group" data-ng-class="{ 'has-error': new_command_error }">
                <div class="input-group">
                  <input id="command" type="text" class="form-control" data-ng-model="new_command_str" data-ng-focus="clearNewCommandError()" data-ng-blur="clearNewCommandError()" placeholder="e.g., insert(5, 'foo')" />
                  <span class="input-group-btn">
                    <input class="btn btn-default" type="submit" data-ng-blur="clearNewCommandError()" value="Go" />
                  </span>
                </div>
                <p class="no-bottom-margin" data-ng-show="new_command_error">{{ new_command_error }}</p>
              </div>
            </form>

            <p class="btn-group no-bottom-margin">
              <a href="#" class="btn btn-default" data-ng-click="stepBackward(); $event.preventDefault();" data-ng-class="{ 'disabled': !canStepBackward() }"><span class="glyphicon glyphicon-chevron-left"></span></a>
              <a href="#" class="btn btn-danger" data-ng-click="resetState(); $event.preventDefault();" data-ng-class="{ 'disabled': !haveCommandHistory() }"><span class="glyphicon glyphicon-repeat"></span> Reset</a>
              <a href="#" class="btn btn-default" data-ng-click="stepForward(); $event.preventDefault();" data-ng-class="{ 'disabled': !canStepForward() }"><span class="glyphicon glyphicon-chevron-right"></span></a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
